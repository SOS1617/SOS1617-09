<html ng-app="testApp">

<head>
    <script type="text/javascript" src="/bower_components/angular/angular.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script>
        angular
            .module("testApp", [])
            .controller("mainCtrl", ["$http", function($http) {
                console.log("Controller intialized");
                $http
                    .get("/serie")
                    .then(function(res) {
                        console.log(res.data);
                        Highcharts.chart('chart', {
                            series: [{
                                data: res.data.map(function(d) {
                                    return Number(d.data);
                                })
                            }]
                        });
                        google.charts.load('current', {
                            'packages': ['geochart']
                        });
                        google.charts.setOnLoadCallback(drawRegionsMap);
                        function drawRegionsMap() {
                            var myData = [['Country', 'Popularity']];
                            res.data.forEach(function (d){
                                myData.push([d.country,d.data]);
                            });
                            var data = google
                                            .visualization
                                            .arrayToDataTable(myData);
                            var options = {};
                            var chart = new google.visualization.GeoChart(
                                        document.getElementById('map'));
                            chart.draw(data, options);
                        }
                    });
            }]);
    </script>
</head>

<body ng-controller="mainCtrl">
    <h1>Test</h1>
    <div id="chart"></div>
    <div id="map"  style="width: 500px; height: 300px;"></div>
</body>

</html>